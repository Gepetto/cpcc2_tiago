#pragma once

// pinocchio
#include <pinocchio/algorithm/frames.hpp>
#include <pinocchio/algorithm/model.hpp>
#include <pinocchio/fwd.hpp>
#include <pinocchio/parsers/urdf.hpp>
// auto-generated by generate_parameter_library
#include <cpcc2_tiago_parameters.hpp>

namespace model_builder {

namespace pin = pinocchio;

/// @brief Build a reduced model from a full model
/// @param urdf_path Path to the urdf file
/// @param joints Vector of the used joints names
pin::Model build_model(std::string urdf_path, std::vector<std::string> joints);

/// @brief update the reduced model
/// @param x Reduced posture
/// @param model Reduced model
/// @param data Reduced data
void update_reduced_model(const Eigen::Ref<const Eigen::VectorXd> &x,
                          pin::Model &model, pin::Data &data);

/// @brief Get the end effector SE3 from the reduced model
/// @param data Reduced data
/// @param end_effector_id End effector frame index
pin::SE3 get_end_effector_SE3(pin::Data &data,
                              pin::FrameIndex &end_effector_id);

}  // namespace model_builder
